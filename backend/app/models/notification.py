"""\nNotification SQLAlchemy Model\nManages in-app notifications and notification center\n"""\n\nfrom datetime import datetime\nfrom sqlalchemy import Column, String, Integer, Boolean, DateTime, Text, ForeignKey, Index\nfrom sqlalchemy.orm import relationship, Mapped, mapped_column\nfrom typing import Optional\n\nfrom app.db.base import Base, TimestampMixin\n\n\nclass Notification(Base, TimestampMixin):\n    """\n    Notification model for in-app messaging and notification center.\n    \n    Types:\n    - success: Positive actions (receipt approved, payment successful)\n    - info: Neutral information (subscription canceled, reminder)\n    - warning: Attention needed (limit warning, expiration notice)\n    - error: Failed actions (payment failed, processing error)\n    \n    Features:\n    - Read/unread tracking\n    - Optional action URL (navigate on click)\n    - Action label (button text for CTA)\n    - Auto-generated timestamps\n    - User scoped (cascade delete on user deletion)\n    """\n    __tablename__ = "notifications"\n    \n    # Primary Key\n    id: Mapped[int] = mapped_column(Integer, primary_key=True, index=True)\n    user_id: Mapped[int] = mapped_column(Integer, ForeignKey("users.id", ondelete="CASCADE"), nullable=False, index=True)\n    \n    # Content\n    type: Mapped[str] = mapped_column(String(50), nullable=False)  # success, info, warning, error\n    title: Mapped[str] = mapped_column(String(255), nullable=False)\n    message: Mapped[str] = mapped_column(Text, nullable=False)\n    \n    # Optional metadata (for actionable notifications)\n    action_url: Mapped[Optional[str]] = mapped_column(String(500), nullable=True)\n    action_label: Mapped[Optional[str]] = mapped_column(String(100), nullable=True)\n    \n    # Status tracking\n    is_read: Mapped[bool] = mapped_column(Boolean, default=False, index=True)\n    read_at: Mapped[Optional[datetime]] = mapped_column(DateTime(timezone=True), nullable=True)\n    \n    # Relationships\n    user = relationship("User", back_populates="notifications")\n    \n    # Composite indexes for common queries\n    __table_args__ = (\n        Index('ix_notifications_user_created', 'user_id', 'created_at'),\n        Index('ix_notifications_user_read', 'user_id', 'is_read'),\n    )\n    \n    def __repr__(self):\n        return f"<Notification(id={self.id}, user_id={self.user_id}, type={self.type}, title={self.title[:30]})>"